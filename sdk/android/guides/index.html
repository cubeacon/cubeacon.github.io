---
layout: sdkandroidpost
title: Guides
cover: cover.jpg
date:   2014-07-17 18:00:00
categories: posts
---


<h2 id="cubeacon-sdk-installation">Cubeacon SDK Installation</h2>
<ol>
<li>Register to <a href="http://developer.cubeacon.com">Cubeacon SaaS</a> and download <code>CubeaconSDK-Android-xxx.zip</code>.</li>
<li>Extract <code>CubeaconSDK-Android-xxx.zip</code>, copy <code>Cubeacon.properties</code> to the root of your project&#39;s Java <code>src</code> source folder.</li>
<li>Then copy <code>CuBeacon-xxx.jar</code> to your <code>libs</code> directory.</li>
<li><p>Add following permissions and service declaration to your <code>AndroidManifest.xml</code>:</p>
<pre><code class="lang-xml"> <span class="hljs-comment">&lt;!-- Needed permissions in order to generate meta users. --&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-title">uses-permission</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"android.permission.READ_PHONE_STATE"</span>/&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-title">uses-permission</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"android.permission.ACCESS_WIFI_STATE"</span>/&gt;</span>

 <span class="hljs-comment">&lt;!-- Needed permissions in order to connect to internet. --&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-title">uses-permission</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"android.permission.INTERNET"</span> /&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-title">uses-permission</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"android.permission.WRITE_EXTERNAL_STORAGE"</span> /&gt;</span>

 <span class="hljs-comment">&lt;!-- Needed permissions in order to scan for beacons. --&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-title">uses-permission</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"android.permission.BLUETOOTH"</span> /&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-title">uses-permission</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"android.permission.BLUETOOTH_ADMIN"</span> /&gt;</span>

 <span class="hljs-comment">&lt;!-- Declaration that this app is usable on phones with Bluetooth Low Energy. --&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-title">uses-feature</span>
     <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"android.hardware.bluetooth_le"</span>
     <span class="hljs-attribute">android:required</span>=<span class="hljs-value">"true"</span> /&gt;</span>
</code></pre>
<pre><code class="lang-xml"> <span class="hljs-comment">&lt;!-- Cubeacon service responsible for scanning beacons. --&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-title">service</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"com.eyro.cubeacon.CBService"</span> 
     <span class="hljs-attribute">android:exported</span>=<span class="hljs-value">"false"</span> /&gt;</span>
 <span class="hljs-comment">&lt;!-- Service that responsible to send Analytic data --&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-title">service</span> <span class="hljs-attribute">android:name</span>=<span class="hljs-value">"com.kii.cloud.analytics.EventUploadService"</span> /&gt;</span>
</code></pre>
</li>
<li><p>Create custom application class and add the following code to the <code>onCreate()</code> method to initialize the Cubeacon SDK.</p>
<pre><code class="lang-java"> <span class="hljs-annotation">@Override</span>
 <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onCreate</span><span class="hljs-params">()</span> </span>{
     <span class="hljs-keyword">super</span>.onCreate();
     <span class="hljs-comment">// Cubeacon SDK Initialization</span>
     CBApp.setup(<span class="hljs-keyword">this</span>, <span class="hljs-string">"Cubeacon.properties"</span>);
 }
</code></pre>
<p> Don&#39;t forget to initialize your custom application class to <code>AndroidManifest.xml</code></p>
<p> (Optional) You can add some custom setup :</p>
<ul>
<li>Enable Cubeacon SDK debug logging when on development mode by calling <code>CBApp.enableDebugLogging(true)</code>.</li>
<li>Enable download image brohure on local path by calling <code>CBapp.enableDownloadImage(true)</code>.</li>
</ul>
</li>
</ol>
<h2 id="usage-and-demos">Usage and Demos</h2>
<p>You can import <code>Cubeacon SDK Demos</code> that located in this repo to your ADT. After initialization, you must download all beacon data from Cloud first.</p>
<p>Quick start to download cloud data :</p>
<pre><code class="lang-java">CBApp.refreshBeaconInBackground(<span class="hljs-keyword">new</span> CB.RefreshBeacon() {
    <span class="hljs-annotation">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onRefreshCompleted</span><span class="hljs-params">(<span class="hljs-keyword">boolean</span> result, String messages)</span> </span>{
        <span class="hljs-comment">// do something after download complete</span>
        <span class="hljs-comment">// like showing main screen of your app</span>
    }
});
</code></pre>
<p>(Info) <code>CBApp.refreshBeaconInBackground</code> are implemented using background <code>AsyncTask</code> method.</p>
<p>Then, extends your activity that used for detected beacon to <code>CBActivity</code> class and implement all abstract method :</p>
<pre><code class="lang-java">    <span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MainActivity</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">CBActivity</span> </span>{
        <span class="hljs-annotation">@Override</span>
        <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(Bundle savedInstanceState)</span> </span>{
            <span class="hljs-keyword">super</span>.onCreate(savedInstanceState);
            setContentView(R.layout.activity_main);
        }

        <span class="hljs-annotation">@Override</span>
        <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onBeaconExited</span><span class="hljs-params">(CBBeacon beacon, <span class="hljs-keyword">long</span> timeInterval)</span> </span>{
            <span class="hljs-comment">// do something when beacon exited region</span>
        }

        <span class="hljs-annotation">@Override</span>
        <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onBeaconEntered</span><span class="hljs-params">(CBBeacon beacon)</span> </span>{
            <span class="hljs-comment">// do something when beacon entered region</span>
        }

        <span class="hljs-annotation">@Override</span>
        <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onNearestBeaconChanged</span><span class="hljs-params">(CBBeacon old, CBBeacon current)</span> </span>{
            <span class="hljs-comment">// do something when nearest beacon changed</span>
            <span class="hljs-keyword">if</span>(current.getStoryline().equals(Storyline.IMAGE)){
                <span class="hljs-comment">// display a brochure image</span>
            }<span class="hljs-function"><span class="hljs-keyword">else</span> <span class="hljs-title">if</span><span class="hljs-params">(current.getStoryline()</span>.<span class="hljs-title">equals</span><span class="hljs-params">(Storyline.TEXT)</span>)</span>{
                <span class="hljs-comment">// show text alert/notification</span>
            }<span class="hljs-function"><span class="hljs-keyword">else</span> <span class="hljs-title">if</span><span class="hljs-params">(current.getStoryline()</span>.<span class="hljs-title">equals</span><span class="hljs-params">(Storyline.HTML)</span>)</span>{
                <span class="hljs-comment">// show html page via webview</span>
            }<span class="hljs-function"><span class="hljs-keyword">else</span> <span class="hljs-title">if</span><span class="hljs-params">(current.getStoryline()</span>.<span class="hljs-title">equals</span><span class="hljs-params">(Storyline.URL)</span>)</span>{
                <span class="hljs-comment">// open url in a webview/browser</span>
            }<span class="hljs-function"><span class="hljs-keyword">else</span> <span class="hljs-title">if</span><span class="hljs-params">(current.getStoryline()</span>.<span class="hljs-title">equals</span><span class="hljs-params">(Storyline.VIDEO)</span>)</span>{
                <span class="hljs-comment">// play a video streaming</span>
            }
        }

        <span class="hljs-annotation">@Override</span>
        <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onBeaconEmpty</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-comment">// do something when no beacon detected</span>
        }
    }
</code></pre>
<h3 id="meta-users">Meta Users</h3>
<p>By improving analytics usage and user engagement, Cubeacon SDK enhanced with <code>Meta User</code> module. This module is optional. So if you want to get user informations like <code>fullname</code> and <code>email</code>, show a form with 2 textinput and you can save into cloud like this :</p>
<pre><code class="lang-java">    CBUser.setUserData(<span class="hljs-string">"User fullname"</span>, <span class="hljs-string">"User valid email"</span>);
    CBUser.currentUser().sendDataInBackground(<span class="hljs-keyword">new</span> Callback() {
        <span class="hljs-annotation">@Override</span>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onCompleted</span><span class="hljs-params">(Exception exp)</span> </span>{
            <span class="hljs-keyword">if</span> (exp == <span class="hljs-keyword">null</span>)
                <span class="hljs-comment">// show succesfull message</span>
            <span class="hljs-keyword">else</span>
                <span class="hljs-comment">// show error message by exp.getMessage()</span>
        }
    });
</code></pre>
<h2 id="changelog">Changelog</h2>
<ul>
<li>1.2.0 (January 17, 2015)<ul>
<li>Add meta user for analytics</li>
<li>Comply with current Cubeacon SaaS v1.2.0</li>
</ul>
</li>
<li>1.0.0 (November 10, 2014)<ul>
<li>Add new base CBActivity class</li>
<li>Improve stability</li>
<li>Comply with current Cubeacon SaaS v1.0.0</li>
<li>Combine all required library into single file</li>
<li>Fix automatic background and foreground scanning</li>
</ul>
</li>
<li>0.5.0 (August 25, 2014)<ul>
<li>Initial release</li>
</ul>
</li>
</ul>